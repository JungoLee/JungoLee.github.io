

var mainJSInit=	function($, win, doc) {
    'use strict';

    var _bannerTime = null;
    var _bannerInnerTime1 = null;
    var _bannerInnerTime2 = null;

    function setBannerHeight() {
        $('.section.banner').css('height', $(window).height());
    }

    function resizeImageRatio() {
        var _ww = window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth;
        var insightImgWrap = $('.section.insight .img-wrap'), newsImgWrap = $('.section.news .img-wrap');
        if(_ww < 769) {
            var ratioInsight = 106.05, ratioNews = 62.5;
            var heightInsight = insightImgWrap.width() * ratioInsight / 100, heightNews = newsImgWrap.width() * ratioNews / 100;
            insightImgWrap.css('height', heightInsight);
            newsImgWrap.css('height', heightNews);
        } else {
            insightImgWrap.css('height', '');
            newsImgWrap.css('height', '');
        }
    }

    function animateBanner() {
        var _b = $('.section.banner'), _control = _b.find('.controller');

        _b.addClass('play');
        _bannerTime = setInterval(function() {
            if(!_b.hasClass('stop')) {
                var _nowItem = _b.find('li.on'), _nextItem = _nowItem.next('li');
                if(_nextItem.length == 0) {
                    _nextItem = _b.find('li.item-01');
                }
                _nextItem.addClass('view on');
                _nowItem.removeClass('on');
                _bannerInnerTime1 = setTimeout(function() {
                    _nowItem.removeClass('view leave');
                }, 1000);
                _bannerInnerTime2 = setTimeout(function() {
                    if(_nextItem.hasClass('view on')) {
                        _nextItem.addClass('leave');
                    }
                }, 7000);
                _control.find('button').removeClass('on');
                _control.find('.btn-dot').eq(_nextItem.attr('data-index')-1).addClass('on');
            }
        }, 8500);
    }

    function setMainGnbBg() {
        var _gnbBottom = $('.gnb .gnb-wrap.wrap-bottom');
        if ($(win).scrollTop() >= 0) {
            _gnbBottom.css({
                'background-color' : 'transparent',
                'border-color' : 'transparent'
            });
            $('.gnb .gnb-inner .menu a img').css({
                'margin-top' : ''
            });
        }
        if ($(win).scrollTop() >= 50) {
            _gnbBottom.css({
                'background-color' : 'rgba(255,255,255,.2)',
                'border-color' : 'rgba(153,153,153,.2)'
            });
            $('.gnb .gnb-inner .menu a img').css({
                'margin-top' : '0'
            });
        }
        if ($(win).scrollTop() >= 100) {
            _gnbBottom.css({
                'background-color' : 'rgba(255,255,255,.4)',
                'border-color' : 'rgba(153,153,153,.4)'
            });
        }
        if ($(win).scrollTop() >= 150) {
            _gnbBottom.css({
                'background-color' : 'rgba(255,255,255,.6)',
                'border-color' : 'rgba(153,153,153,.6)'
            });
        }
        if ($(win).scrollTop() >= 200) {
            _gnbBottom.css({
                'background-color' : 'rgba(255,255,255,.8)',
                'border-color' : 'rgba(153,153,153,.8)'
            });
        }
        if ($(win).scrollTop() >= 250) {
            _gnbBottom.css({
                'background-color' : 'rgba(255,255,255,1)',
                'border-color' : 'rgba(153,153,153,1)'
            });
        }
    }

    function popupWrapResize(ww) {
        ww = win.innerWidth || doc.documentElement.clientWidth || doc.body.clientWidth;
        var $popupWrap = $('.popup-wrap'), $popups = $popupWrap.find('.popups');
        if(ww > 768) {
            var w = $popups.innerWidth();
            $popupWrap.css('width', w);
        } else {
            $popupWrap.css('width', '');
        }
    }

    function thumbnailResize(ww) {
        ww = win.innerWidth || doc.documentElement.clientWidth || doc.body.clientWidth;
        var imgWide = $('.img-wide img'), imgLong = $('.img-long img');
        if(ww < 769) {
            var ratioWide = 64.28, ratioLong = 117.85;
            var widthWide = imgWide.width(), widthLong = imgLong.width();
            var heightWide = widthWide * ratioWide / 100, heightLong = widthLong * ratioLong / 100;
            imgWide.css('height', heightWide);
            imgLong.css('height', heightLong);
        } else {
            imgWide.css('height', '');
            imgLong.css('height', '');
        }
    }

    function changeItem(ww) {
        ww = win.innerWidth || doc.documentElement.clientWidth || doc.body.clientWidth;

        var $el = $('.section.content-segment');
        var _pcWrap = $('.content-segment .section-inner > .ul-wrap.is-pc'), _mobileWrap = $('.content-segment .section-inner > .ul-wrap.is-mobile');
        var _num = ($('[data-linkage]').length) / 2;
        var _pcItem, _mobileItem;
        if(ww < 769) {
            if(!$el.hasClass('change-item')) {
                for(var i = 1; i <= _num; i++) {
                    _pcItem = _pcWrap.find("[data-linkage="+i+"] > .linkage-content");
                    _mobileItem = _mobileWrap.find("[data-linkage="+i+"] ");
                    _pcItem.appendTo(_mobileItem);
                }
                $el.addClass('change-item');
            }
        }
        else {
            if ($el.hasClass('change-item')) {
                for(var i = 1; i <= _num; i++) {
                    _pcItem = _pcWrap.find("[data-linkage="+i+"]");
                    _mobileItem = _mobileWrap.find("[data-linkage="+i+"] > .linkage-content");
                    _mobileItem.appendTo(_pcItem);
                }
                $el.removeClass('change-item');
            }
        }
    }

    $(function() {
        var $html = $('html');
        var ww = win.innerWidth || doc.documentElement.clientWidth || doc.body.clientWidth;
        var $popup = $('.popup'), $btnPopupClose = $popup.find('.btn-popup-close');

        setMainGnbBg();

        $popup.addClass('show');

        //--------------------------------------------------------------
        resizeImageRatio();
        setBannerHeight();

        var _banner = $('.section.banner');
        var _start = $('.section.banner li.view');
        _start.addClass('on');
        _bannerInnerTime2 = setTimeout(function() {
            if(!_banner.hasClass('stop')) {
                _start.addClass('leave');
            }
        }, 7000);
        animateBanner();

        $('.section.banner .btn-control').on('click', function() {
            if(_banner.attr('data-frozen') == "false") {
                if($(this).hasClass('stop')) {
                    _banner.removeClass('stop');
                    _bannerInnerTime2 = setTimeout(function() {
                        if(!_banner.hasClass('stop')) {
                            $('.section.banner li.view').addClass('leave');
                        }
                    }, 7000);
                    animateBanner();
                    $(this).attr('title', 'STOP');
                } else {
                    clearTimeout(_bannerInnerTime1);
                    clearTimeout(_bannerInnerTime2);
                    clearInterval(_bannerTime);
                    _bannerInnerTime1 = null;
                    _bannerInnerTime2 = null;
                    _bannerTime = null;
                    _banner.addClass('stop');
                    _banner.removeClass('play');
                    _banner.find('li.view.on').siblings().removeClass('view on leave');
                    _banner.find('li.view.on').removeClass('leave');
                    $(this).attr('title', 'START');
                }
                $(this).toggleClass('stop');
            }
        });
        $('.section.banner .btn-dot').on('click', function() {
            if(_banner.attr('data-frozen') == "false" && !$(this).hasClass('on')) {
                _banner.attr('data-frozen', "true");
                var _idx = $(this).index()+1;
                var _selItem = _banner.find('li[data-index='+_idx+']');
                var _nowItem = _banner.find('li.on');

                if(!_banner.hasClass('stop')) {
                    _nowItem.addClass('old');

                    clearTimeout(_bannerInnerTime1);
                    clearTimeout(_bannerInnerTime2);
                    clearInterval(_bannerTime);
                    _bannerInnerTime1 = null;
                    _bannerInnerTime2 = null;
                    _bannerTime = null;

                    _selItem.addClass('view on');
                    _bannerInnerTime2 = setTimeout(function() {
                        if(!_banner.hasClass('stop')) {
                            _selItem.addClass('leave');
                        }
                    }, 7000);
                    setTimeout(function() {
                        _nowItem.addClass('stop');
                        _selItem.siblings('li').removeClass('view on leave old');
                        setTimeout(function() {
                            _nowItem.removeClass('stop');
                            _banner.attr('data-frozen', "false");
                        }, 100);
                    }, 1000);
                    animateBanner();

                    _banner.find('.btn-dot').removeClass('on');
                    $(this).addClass('on');
                } else {
                    _selItem.addClass('view on');
                    _nowItem.removeClass('view on leave');

                    _banner.find('.btn-dot').removeClass('on');
                    $(this).addClass('on');
                    _banner.attr('data-frozen', "false");
                }
            }
        });
        // var waypoint01 = new Waypoint({
        //     element: document.getElementById('sectionNews'),
        //     handler: function (direction) {
        //         if (direction == 'down') {
        //             $('.section.news').addClass('animate');
        //         } else {
        //             $('.section.news').removeClass('animate');
        //         }
        //     },
        //     offset: '45%'
        // });
        var waypoint02 = new Waypoint({
            element: document.getElementById('wpQuickLink01'),
            handler: function (direction) {
                if (direction == 'down') {
                    $('.section.quick-link li.item-01').addClass('animate');
                } else {
                    $('.section.quick-link li.item-01').removeClass('animate');
                }
            },
            offset: '80%'
        });
        var waypoint03 = new Waypoint({
            element: document.getElementById('wpQuickLink02'),
            handler: function (direction) {
                if (direction == 'down') {
                    $('.section.quick-link li.item-02').addClass('animate');
                } else {
                    $('.section.quick-link li.item-02').removeClass('animate');
                }
            },
            offset: '80%'
        });
        var waypoint04 = new Waypoint({
            element: document.getElementById('wpQuickLink03'),
            handler: function (direction) {
                if (direction == 'down') {
                    $('.section.quick-link li.item-03').addClass('animate');
                } else {
                    $('.section.quick-link li.item-03').removeClass('animate');
                }
            },
            offset: '80%'
        });
        // var waypoint05 = new Waypoint({
        //     element: document.getElementById('wpInsight01'),
        //     handler: function (direction) {
        //         if (direction == 'down') {
        //             $('.section.insight li.item-01').addClass('animate');
        //         } else {
        //             $('.section.insight li.item-01').removeClass('animate');
        //         }
        //     },
        //     offset: '45%'
        // });
        // var waypoint06 = new Waypoint({
        //     element: document.getElementById('wpInsight02'),
        //     handler: function (direction) {
        //         if (direction == 'down') {
        //             $('.section.insight li.item-02').addClass('animate');
        //         } else {
        //             $('.section.insight li.item-02').removeClass('animate');
        //         }
        //     },
        //     offset: '45%'
        // });
        // var waypoint07 = new Waypoint({
        //     element: document.getElementById('wpInsight03'),
        //     handler: function (direction) {
        //         if (direction == 'down') {
        //             $('.section.insight li.item-03').addClass('animate');
        //         } else {
        //             $('.section.insight li.item-03').removeClass('animate');
        //         }
        //     },
        //     offset: '45%'
        // });
        $('.section.quick-link .link-wrap a').on('mouseenter focusin', function() {
            $(this).addClass('animate');
        });
        $('.section.quick-link .link-wrap a').on('mouseleave focusout', function() {
            $(this).removeClass('animate');
        });

        //--------------------------------------------------------------


        $(win).resize(function() {
            var newWw = win.innerWidth || doc.documentElement.clientWidth || doc.body.clientWidth;
            setMainGnbBg();
            setBannerHeight();
            if(ww !== newWw || $html.hasClass('device-type-desktop')) {
                resizeImageRatio();

                ww = newWw;
            }
            if(ww<769) {
                Waypoint.refreshAll();
            }
            if(!$html.hasClass('device-type-desktop')) {
                $(win).on('orientationchange', function() {
                    ww =  win.innerWidth || doc.documentElement.clientWidth || doc.body.clientWidth;
                });
            }
        });

        $(win).on('scroll', function() {
            setMainGnbBg();
        });

    });

};

	

	

	

	