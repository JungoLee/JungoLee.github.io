

	var layoutJsInit = function($, win, doc) {
    'use strict';

    $.fn.extend({
        gaClickCount: function(){
            $(this).on('click', function(){
                var documentTitle = document.title;
                var dataGaLabel = $.trim($(this).attr('data-galabel'));
                if(documentTitle == "SK telecom") {
                    documentTitle = "메인 페이지";
                }
                else {
                    documentTitle = documentTitle.substr(0, documentTitle.indexOf('<')) + ' 페이지';
                }
                ga('send', 'event', {
                    eventCategory: documentTitle,
                    eventAction: 'click',
                    eventLabel: dataGaLabel,
                    transport: 'beacon'
                });
            });
        }
    });

        $.extend($, {
            settingContainerPadding: function() {
                var _ww = win.innerWidth || doc.documentElement.clientWidth || doc.body.clientWidth;
                var $container = $('.container');
                var fh = $('.footer').outerHeight();
                if(_ww > 768) {
                    $container.css('padding-bottom', fh + 30);
                } else {
                    $container.css('padding-bottom', fh + 26);
                }
            },
            openPopup: function(event, el) {
                event.preventDefault();
                var url = el.getAttribute('href');
                var width=550;
                var height=440;

                var sw = screen.availWidth;
                var sh = screen.availHeight;

                var px = (sw - width) / 2;
                var py = (sh - height) / 2;
                // px += window.screenLeft;

                var set = 'top=' + py + ',left=' + px;
                set += ',width=' + width + ',height=' + height + ',location=no,scrollbars=yes,resizable=yes';

                window.open(url, 'popup', set);
            },
            openPopupWindow: function(event, _url) {
                event.preventDefault();
                var url = _url;
                var width=550;
                var height=440;

                var sw = screen.availWidth;
                var sh = screen.availHeight;

                var px = (sw - width) / 2;
                var py = (sh - height) / 2;
                // px += window.screenLeft;

                var set = 'top=' + py + ',left=' + px;
                set += ',width=' + width + ',height=' + height + ',location=no,scrollbars=yes,resizable=yes';

                window.open(url, 'popup', set);
            }
        });

        function adThumbnailResize(w) {
            if($('#content_inner').hasClass('advertise-page')) {
                var img = $('.list-wrap').find('img');
                var ratio = 56.25, imgW = img.width();
                if(w < 769) {
                    var imgH = imgW * ratio / 100;
                    img.css('height', imgH);
                } else {
                    img.css('height', '');
                }
            }
        }

        function boardThumbnailResize(w) {
            if($('.container').find('.board-detail-thumbnail').length > 0) {
                var img = $('.board-detail-thumbnail').find('img.thumbnail');
                var ratio = 56.25, imgW = img.width();
                if(w < 769) {
                    var imgH = imgW * ratio / 100;
                    img.css('height', imgH);
                } else {
                    img.css('height', '');
                }
            }
        }

        function checkScreenSize(ww) {
            ww = win.innerWidth || doc.documentElement.clientWidth || doc.body.clientWidth;
            var $html = $('html');
            var small = 'screen-small', large = 'screen-large';
            if(ww > 768) {
                if($html.hasClass(small)) {
                    $html.removeClass(small);
                }
                if(! $html.hasClass(large)) {
                    $html.addClass(large);
                }
            } else {
                if($html.hasClass(large)) {
                    $html.removeClass(large);
                }
                if(! $html.hasClass(small)) {
                    $html.addClass(small);
                }
            }
        }

        function resetSubMenu(ww, smt) {
            ww = win.innerWidth || doc.documentElement.clientWidth || doc.body.clientWidth;
            if(ww > 768) {
                $('.gnb').removeClass('expanded');
                smt.removeAttr('tabindex');
            } else {
                var $subMenuItem = $('.gnb .gnb-menu-wrap > .sub-menu .sub-menu-item');
                $('.gnb .gnb-menu-wrap > .sub-menu').css('height', '');
                $subMenuItem.removeClass('expanded');
                smt.attr('tabindex', '0');
            }
        }

        function familySiteButtonTop(ww, fs, btn) {
            ww = win.innerWidth || doc.documentElement.clientWidth || doc.body.clientWidth;
            if(fs.hasClass('expanded')) {
                var fsh = fs.outerHeight(), t = fsh;
                ww > 768 ? t += 33 : t += 27;
                btn.css('top', '-' + t + 'px');
            } else {
                btn.css('top', '');
            }
        }

        $(function() {
            var $html = $('html');
            var ww = win.innerWidth || doc.documentElement.clientWidth || doc.body.clientWidth;
            var g = $('.gnb'), $menu = g.find('.menu'), $subMenu = $('.gnb .gnb-menu-wrap > .sub-menu');
            var $subMenuItem = $('.gnb .gnb-menu-wrap > .sub-menu .sub-menu-item');
            var $subMenuItemTitle = $subMenu.find('.sub-menu-item > .sub-menu-title');
            var $btnSubMenuToggle = $menu.find('a');
            // var $btnSubMenuClose = $subMenu.find('.btn-sub-menu-close');
            var $footer = $('.footer'), fs = $footer.find('.family-site'), $btnFamilySiteToggle = $footer.find('.btn-family-site-toggle');
            var _toTop = $('#btn_page_top');
            var scrolled = $(win).scrollTop() > 0;
            _toTop.toggle(scrolled);

            _toTop.click(function() {
                $('html, body').animate({scrollTop: 0}, '600', 'swing');
                g.focus();
            });
            $('.container').append(_toTop);
            g.attr('tabindex', '-1');

            checkScreenSize(ww);

            if(!$('#content_inner').hasClass('notice-page') && !$('#content_inner').hasClass('news-page')) {
                $('.multi-ellipsis').ellipsis(true);
            }
            boardThumbnailResize(ww);
            resetSubMenu(ww, $subMenuItemTitle);
            adThumbnailResize(ww);
            setTimeout(function() {
                boardThumbnailResize(ww);
                adThumbnailResize(ww);
                if(!$('#content_inner').hasClass('notice-page') && !$('#content_inner').hasClass('news-page')) {
                    $('.multi-ellipsis').ellipsis(true);
                }
            }, 2500);

            $(win).resize(function() {
                var newWw = win.innerWidth || doc.documentElement.clientWidth || doc.body.clientWidth;
                if(ww !== newWw) {
                    scrolled = $(win).scrollTop() > 0;
                    _toTop.toggle(scrolled);
                    if(!$('#content_inner').hasClass('notice-page') && !$('#content_inner').hasClass('news-page')) {
                        $('.multi-ellipsis').ellipsis(true);
                    }
                    boardThumbnailResize(newWw);
                    checkScreenSize(ww);
                    familySiteButtonTop(ww, fs, $btnFamilySiteToggle);
                    resetSubMenu(ww, $subMenuItemTitle);
                    adThumbnailResize(ww);
                    ww = newWw;
                }
                if(!$html.hasClass('device-type-desktop')) {
                    $(win).on('orientationchange', function() {
                        ww = win.innerWidth || doc.documentElement.clientWidth || doc.body.clientWidth;
                    });
                }
            });

            $(win).scroll(function() {
                scrolled = $(win).scrollTop() > 0;
                _toTop.toggle(scrolled);
            });

            var _gnbMenuHeight = 0;
            if($html.attr('lang') === 'ko') {
                _gnbMenuHeight = 375;
            } else {
                _gnbMenuHeight = 578;
            }

            $menu.find('a').keydown(function(e) {
                var _c = $(this).parent().attr('class');
                var _start = _c.indexOf('menu-item-');
                var i = _c.substr(_start+10, 2);
                if (e.which == 9 && e.shiftKey) {
                    if($(this).parent().hasClass('menu-item-01')) {
                        if(ww > 768) {
                            if(g.hasClass('expanded')) {
                                $btnSubMenuToggle.removeClass('selected');
                                $subMenuItem.removeClass('focus');
                                $subMenu.css('display','block');
                                g.removeClass('expanded');
                                $subMenu.stop().animate({"height":0}, 300, function() {
                                    $subMenu.css('display','');
                                });
                            }
                        }
                    }
                } else if (e.which == 9) {
                    if(ww > 768) {
                        if(g.hasClass('expanded')) {
                            $subMenu.find('.sub-menu-item.item-'+i).focus();
                        }
                    }
                }
            });
            $btnSubMenuToggle.on('mouseenter focus', function(e) {
                var _num = ($menu.find('>li').index($(this).parent('li'))*1) + 1;
                $btnSubMenuToggle.removeClass('selected');
                $subMenuItem.removeClass('focus');
                $(this).addClass('selected');
                $subMenu.find('.sub-menu-item.item-0'+_num).addClass('focus');
                if(!g.hasClass('expanded')) {
                    g.addClass('expanded');
                    $subMenu.stop().animate({"height":_gnbMenuHeight}, 300);
                }
            });
            $subMenuItem.mouseenter(function(e) {
                if(ww > 768) {
                    var _num = ($subMenuItem.index($(this))*1) + 1;
                    $btnSubMenuToggle.removeClass('selected');
                    $subMenuItem.removeClass('focus');
                    $menu.find('>li.menu-item-0'+_num + ' a').addClass('selected');
                    $(this).addClass('focus');
                }
            });
            $subMenu.find('.sub-menu-inner li.sub-menu-item .sub-menu-contents li.menu-link-wrap:first-child > a').keydown(function(e) {
                var _c = $(this).closest('.sub-menu-item').attr('class');
                var _start = _c.indexOf('item-0');
                var i = (_c.substr(_start+6, 1))*1;

                if (e.which == 9 && e.shiftKey) {
                    if(ww > 768) {
                        $menu.find('.menu-item-0'+i+' img').focus();
                    }
                }
            });
            $subMenu.find('.sub-menu-inner li.sub-menu-item:not(:last-child) .sub-menu-contents > ul:last-child  li.menu-link-wrap:last-child').keydown(function(e) {
                var _c = $(this).closest('.sub-menu-item').attr('class');
                var _start = _c.indexOf('item-0');
                var i = (_c.substr(_start+6, 1))*1;
                i++;

                if($(this).hasClass('sub-link')) {
                    if (e.which == 9 && e.shiftKey) {
                        // do nothing
                    } else if (e.which == 9) {
                        if(ww > 768) {
                            if(g.hasClass('expanded')) {
                                $menu.find('.menu-item-0'+i).focus();
                            }
                        }
                    }
                }
            });
            $subMenu.find('.sub-menu-inner li.sub-menu-item:not(:last-child) .sub-menu-contents > ul:last-child li.menu-link-wrap:last-child .sub-link:last-child').keydown(function(e) {
                var _c = $(this).closest('.sub-menu-item').attr('class');
                var _start = _c.indexOf('item-0');
                var i = (_c.substr(_start+6, 1))*1;
                i++;

                if($(this).hasClass('sub-link')) {
                    if (e.which == 9 && e.shiftKey) {
                        // do nothing
                    } else if (e.which == 9) {
                        if(ww > 768) {
                            if(g.hasClass('expanded')) {
                                $menu.find('.menu-item-0'+i).focus();
                            }
                        }
                    }
                }
            });
            $subMenu.find('.sub-menu-inner li.sub-menu-item:last-child .sub-menu-contents li.menu-link-wrap:last-child').keydown(function(e) {
                if($(this).hasClass('sub-link')) {
                    if (e.which == 9 && e.shiftKey) {
                        // do nothing
                    } else if (e.which == 9) {
                        if(ww > 768) {
                            if(g.hasClass('expanded')) {
                                $btnSubMenuToggle.removeClass('selected');
                                $subMenuItem.removeClass('focus');
                                $subMenu.css('display','block');
                                g.removeClass('expanded');
                                $subMenu.stop().animate({"height":0}, 300, function() {
                                    $subMenu.css('display','');
                                });
                            }
                        }
                    }
                }
            });
            $subMenu.find('.sub-menu-inner li.sub-menu-item:last-child .sub-menu-contents li.menu-link-wrap:last-child .sub-link:last-child').keydown(function(e) {
                if (e.which == 9 && e.shiftKey) {
                    // do nothing
                } else if (e.which == 9) {
                    if(ww > 768) {
                        if(g.hasClass('expanded')) {
                            $btnSubMenuToggle.removeClass('selected');
                            $subMenuItem.removeClass('focus');
                            $subMenu.css('display','block');
                            g.removeClass('expanded');
                            $subMenu.stop().animate({"height":0}, 300, function() {
                                $subMenu.css('display','');
                            });
                        }
                    }
                }
            });
            $('.gnb > .gnb-menu-wrap').mouseleave(function(e) {
                if(ww > 768) {
                    if(g.hasClass('expanded')) {
                        $btnSubMenuToggle.removeClass('selected');
                        $subMenuItem.removeClass('focus');
                        $subMenu.css('display','block');
                        g.removeClass('expanded');
                        $subMenu.stop().animate({"height":0}, 300, function() {
                            $subMenu.css('display','');
                        });
                    }
                }
            });

            $('.gnb .btn-hamburger-menu').click(function(e) {
                e.preventDefault();
                g.toggleClass('expanded');
                if(g.hasClass('expanded')) {
                    $(win).scrollTop(0);
                } else {
                    $subMenuItem.removeClass('expanded');
}
                if($('container').hasClass('main-page')) {
                    Waypoint.refreshAll();
                }
            });
            $subMenuItemTitle.click(function() {
                ww = win.innerWidth || doc.documentElement.clientWidth || doc.body.clientWidth;
                if(ww < 769) {
                    var i = $(this).closest('.sub-menu-item');
                    i.siblings('.sub-menu-item').removeClass('expanded');
                    i.toggleClass('expanded');
                    if(i.hasClass('expanded')) {
                        $(win).scrollTop($(this).offset().top);
                    }
                }
            });
            $subMenuItemTitle.keydown(function(e) {
                var keyCode = (e.keyCode ? e.keyCode : e.which);
                if(keyCode === 13) {
                    $(this).trigger('click');
                }
            });

            $btnFamilySiteToggle.click(function() {
                fs.toggleClass('expanded');
                $('.container').toggleClass('family-site-open');
                $.settingContainerPadding();
                familySiteButtonTop(ww, fs, $btnFamilySiteToggle);
                if(fs.hasClass('expanded')) {
                    fs.focus();
                    $(win).scrollTop(fs.offset().top - 185);
                }
                if($('container').hasClass('main-page')) {
                    Waypoint.refreshAll();
                }
            });


            $('input:checkbox').keydown(function(e){
                if((e.keyCode ? e.keyCode : e.which) == 13){
                    $(this).trigger('click');
                }
            });

            $('input:radio').keydown(function(e){
                if((e.keyCode ? e.keyCode : e.which) == 13){
                    $(this).trigger('click');
                }
            });

            $('#content').bind('keyup', function(e) {
                if((e.keyCode ? e.keyCode : e.which) == 9){
                    var wt = $(win).scrollTop();
                    var et = $('*:focus').offset().top;
                    if(et-wt<200) {
                        $(win).scrollTop(wt - 200);
                    }
                }
            });

            $('.footer').bind('keyup', function(e) {
                if((e.keyCode ? e.keyCode : e.which) == 9){
                    var wt = $(win).scrollTop();
                    var et = $('*:focus').offset().top;
                    if(et-wt<200) {
                        $(win).scrollTop(wt - 200);
                    }
                }
            });

            if($html.hasClass('is-ie8')) {
                $("label").on('click', function(){
                    if ($(this).attr("for") != "") {
                        $(this).siblings('input').removeClass('checked')
                            .end().addClass('checked');
                        $("#" + $(this).attr("for")).trigger('click');
                    }
                });
            }

            if($('#content_inner').hasClass('advertise-page')) {
                $('.list-wrap').find('a').click(function() {
                    $('iframe').focus();
                    $(window).scrollTop(100);
                });
            }

            if($('#content_inner').hasClass('faq-page')) {
                if($('.cbody-02 .tab-header').find('.tab-item:first-child').length <= 0) {
                    var faqTimer = setInterval(function() {
                        $('.cbody-02 .tab-header').find('.tab-item:first-child').addClass('active');

                        if($('.cbody-02 .tab-header').find('.tab-item:first-child').hasClass('active')) {
                            clearInterval(faqTimer);
                            faqTimer = null;
                        }
                    }, 500);
                } else {
                    $('.cbody-02 .tab-header').find('.tab-item:first-child').addClass('active');
                }
            }

            if($('#content_inner').hasClass('faq-page')) {
                $('.cbody-02 .tab-header').find('.tab-item a').click(function(e) {
                    $('.cbody-02 .tab-body').focus();
                    $(win).scrollTop($('.cbody-02 .tab-body').offset().top - 250);
                });
            }
            if($('#content_inner').hasClass('downloads-page')) {
                $('.tab-header').find('.tab-item a').click(function(e) {
                    $('.tab-body').focus();
                    $(win).scrollTop($('.tab-body').offset().top - 250);
                });
            }
        });
};

	

	

	

	

	

	

	

	